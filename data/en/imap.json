{
    "engines": {"lucee": {"docs": "https://docs.lucee.org/reference/functions/imap.html"}},
    "name": "imap",
    "description": "Retrieves and deletes messages from an IMAP email server.",
    "syntax": "<imap/>",
    "returns": "void",
    "type": "tag",
    "params": [
        {
            "name": "connection",
            "description": "label for a connection.",
            "default": false,
            "type": "string",
            "required": false
        },
        {
            "name": "server",
            "description": "Host name biff.upperlip.com or IP address 192.1.2.225 of the Imap server.",
            "default": false,
            "type": "string",
            "required": false
        },
        {
            "name": "port",
            "description": "Defaults to the standard Imap port, 143.",
            "default": false,
            "type": "number",
            "required": false
        },
        {
            "name": "uid",
            "description": "Specifies the unique ID or a comma-delimited list of Uids to retrieve or delete. If you set invalid Uids, then they are ignored.",
            "default": false,
            "type": "string",
            "required": false
        },
        {
            "name": "username",
            "description": "If no user name is specified, the Imap connection is anonymous.",
            "default": false,
            "type": "string",
            "required": false
        },
        {
            "name": "password",
            "description": "Password that corresponds to user name.",
            "default": false,
            "type": "string",
            "required": false
        },
        {
            "name": "secure",
            "description": "enables SSL for pop requests",
            "default": false,
            "type": "boolean",
            "required": false
        },
        {
            "name": "action",
            "description": "Specifies the IMAP action to perform.\n\n- getHeaderOnly\n- getAll\n- delete\n- open\n- close\n- markread\n- createfolder\n- deletefolder\n- renamefolder\n- listallfolders\n- movemail\n",
            "default": false,
            "type": "string",
            "required": false
        },
        {
            "name": "name",
            "description": "Name for the index query.",
            "default": false,
            "type": "string",
            "required": false
        },
        {
            "name": "messagenumber",
            "description": "Can be a comma-separated list of the message ids",
            "default": false,
            "type": "string",
            "required": false
        },
        {
            "name": "attachmentpath",
            "description": "Allows attachments to be written to the specified directory when action = \"getAll\". If an\ninvalid attachmentPath is specified, no attachment files are written to the server.",
            "default": false,
            "type": "string",
            "required": false
        },
        {
            "name": "timeout",
            "description": "Specifies the maximum time, in seconds, to wait for mail processing. Defaults is 60 seconds.",
            "default": false,
            "type": "number",
            "required": false
        },
        {
            "name": "maxrows",
            "description": "Sets the number of messages returned, starting with the number in the startRow attribute.\n\nThis attribute is ignored if messageNumber is specified.",
            "default": false,
            "type": "number",
            "required": false
        },
        {
            "name": "startrow",
            "description": "Specifies the first row number to be retrieved. Default is 1. This attribute is ignored if\nmessageNumber is specified.",
            "default": false,
            "type": "number",
            "required": false
        },
        {
            "name": "debug",
            "description": "this attribute is deprecated and ignored, log control happens via the logging framework directly.",
            "default": false,
            "type": "boolean",
            "required": false
        },
        {
            "name": "generateuniquefilenames",
            "description": "Boolean indicating whether to generate unique filenames for the files attached to an e-mail\nmessage to avoid naming conflicts when the files are saved. Default is NO.",
            "default": false,
            "type": "boolean",
            "required": false
        },
        {
            "name": "folder",
            "description": "Folder for action, default is INBOX",
            "default": false,
            "type": "string",
            "required": false
        },
        {
            "name": "newfolder",
            "description": "Name of new folder, used by action renameFolder and moveMail",
            "default": false,
            "type": "string",
            "required": false
        },
        {
            "name": "recurse",
            "description": "Used for action listAllFolders",
            "default": false,
            "type": "boolean",
            "required": false
        },
        {
            "name": "delimiter",
            "description": "Character that separates uid list, The default value is comma(,).",
            "default": false,
            "type": "string",
            "required": false
        }
    ]
}